(this["webpackJsonpelevator-challenge"]=this["webpackJsonpelevator-challenge"]||[]).push([[0],{19:function(e){e.exports=JSON.parse('[{"id":1,"floorsCount":21,"elevatorsCount":4,"elevatorDelay":3,"elevatorSpeed":3},{"id":2,"floorsCount":16,"elevatorsCount":3,"elevatorDelay":2,"elevatorSpeed":3},{"id":3,"floorsCount":11,"elevatorsCount":2,"elevatorDelay":2,"elevatorSpeed":2}]')},25:function(e,t,r){},26:function(e,t,r){},30:function(e,t,r){"use strict";r.r(t);var n,a=r(0),o=r.n(a),c=r(11),u=r.n(c),l=r(8),s=r.n(l),i=r(12),f=r(2),d=(r(25),r(26),r(3)),v=r(13),j=r(15),b=r.p+"static/media/elv.57cf1df4.png",m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=o.a.useState(0),n=Object(f.a)(r,2),a=n[0],c=n[1],u=o.a.useRef({}),l=function e(r){u.current.started||(u.current.started=r,u.current.lastInterval=r);var n=Math.min(t,u.current.timeLeft||1/0);r-u.current.lastInterval>=n&&(u.current.lastInterval+=n,c((function(e){return u.current.timeLeft=e-n,u.current.timeLeft}))),r-u.current.started<u.current.timeToCount?u.current.requestId=window.requestAnimationFrame(e):(u.current={},c(0))},s=o.a.useCallback((function(t){window.cancelAnimationFrame(u.current.requestId);var r=void 0!==t?t:e;u.current.started=null,u.current.lastInterval=null,u.current.timeToCount=r,u.current.requestId=window.requestAnimationFrame(l),c(r)}),[]),i=o.a.useCallback((function(){window.cancelAnimationFrame(u.current.requestId),u.current.started=null,u.current.lastInterval=null,u.current.timeToCount=u.current.timeLeft}),[]),d=o.a.useCallback((function(){!u.current.started&&u.current.timeLeft>0&&(window.cancelAnimationFrame(u.current.requestId),u.current.requestId=window.requestAnimationFrame(l))}),[]),v=o.a.useCallback((function(){u.current.timeLeft&&(window.cancelAnimationFrame(u.current.requestId),u.current={},c(0))}),[]),j=o.a.useMemo((function(){return{start:s,pause:i,resume:d,reset:v}}),[]);return o.a.useEffect((function(){return v}),[]),[a,j]},O=r(14),h=r.p+"static/media/ding.d2cf02a6.mp3",p=r(1),x=function(e){var t=e.elevatorIndex,r=e.elevatorsQueues,n=e.elevatorDelay,o=e.elevatorSpeed,c=e.elevatorLocation,u=e.removeFromQueue,l=e.updateElevatorLocation,s=Object(O.a)(h),i=Object(f.a)(s,1)[0],d=r[t],v=d[0]||null,j=Math.abs(d[0]-c)/o||null,x=m(n,100),y=Object(f.a)(x,2),I=y[0],w=y[1].start;Object(a.useEffect)((function(){I>0&&I<=100&&u(t)}),[I]);var S=v||c;return Object(p.jsx)(C,{src:b,alt:"",travelDuration:j,forcedLocation:110*S,elevatorLocation:110*c,nextFloor:110*v,elevatorDelay:n,onClick:function(){l(t),u(t)},onTransitionEnd:function(){return console.log("SOUND!!!!"),i(),w(1e3*n),void l(t)}})},C=j.a.img(n||(n=Object(v.a)(["\n                position: absolute;\n                width: 110px;\n                bottom: 0;\n                transform: translateY(-","px);\n                transition: transform ","s ease;\n                "])),(function(e){return e.forcedLocation}),(function(e){return e.travelDuration})),y=function(e){var t=e.elevatorsQueues,r=e.elevatorSpeed,n=e.elevatorDelay,a=e.elevatorsLocations,o=e.removeFromQueue,c=e.updateElevatorLocation,u=e.floorsCount;return Object(p.jsx)("div",{className:"shafts",children:t.map((function(e,l){return Object(p.jsx)("div",{style:{height:110*u+8+"px"},className:"shaft",children:Object(p.jsx)(x,{elevatorIndex:l,elevatorsQueues:t,elevatorSpeed:r,elevatorDelay:n,elevatorLocation:a[l],removeFromQueue:o,updateElevatorLocation:c})},l)}))})},I=function(e){var t=e.floorIndex,r=e.addToQueue,n=e.elevatorsQueues,o=e.floorTime,c=n.flat().findIndex((function(e){return e===t}))>-1,u=m(o,100),l=Object(f.a)(u,2),s=l[0],i=l[1].start;return Object(a.useEffect)((function(){i(1e3*o)}),[o]),Object(p.jsxs)("div",{className:"floor floor-size",children:[Object(p.jsx)("div",{className:"blackline"}),Object(p.jsx)("button",{className:"controller metal linear ".concat(c?"active":""),onClick:function(){r(t)},children:t}),s&&Object(p.jsx)("p",{children:(s/1e3).toFixed(1)})]})},w=function(e){var t=e.floors,r=e.addToQueue,n=e.elevatorsQueues,a=e.floorTimes;return Object(p.jsx)("div",{className:"floors",children:t.map((function(e,t,o){return Object(p.jsx)("div",{className:"floor",children:Object(p.jsx)(I,{floorIndex:t,floorTime:a[t],elevatorsQueues:n,addToQueue:r})},t)}))})},S=function(e){var t=e.floorsCount,r=e.elevatorsCount,n=e.elevatorDelay,o=e.elevatorSpeed,c=Object(d.a)(Array(t).fill(null)),u=Object(a.useState)(Array.from(Array(r),(function(){return new Array(0)}))),l=Object(f.a)(u,2),s=l[0],i=l[1],v=Object(a.useState)(Object(d.a)(Array(r).fill(0))),j=Object(f.a)(v,2),b=j[0],m=j[1],O=Object(a.useState)(Object(d.a)(Array(t).fill(null))),h=Object(f.a)(O,2),x=h[0],C=h[1],I=Object(a.useState)(!0),S=Object(f.a)(I,2),g=S[0],L=S[1],Q=function(e,t){var r=A(e,t),n=Object(d.a)(x);n[e]=r,C(n)},A=function(e,t){var r=s[t].findIndex((function(t){return t===e}));if(-1!==r){var a=s[t].slice(0,r+1),c=0;return a.length>1&&a.forEach((function(e,t,r){c=c+=t>0?Math.abs(r[t]-r[t-1]):0})),(c+=Math.abs(b[t]-a[0]))/o+n*(a.length-1)}},D=function(e){var t=Object(d.a)(Array(r).fill(1/0));return s.forEach((function(r,a){r=[].concat(Object(d.a)(r),[e]);var c=0;r.length>1&&r.forEach((function(e,t,r){c=c+=t>0?Math.abs(r[t]-r[t-1]):0}));var u=(c+=Math.abs(b[a]-e))/o+n*(r.length-1);t[a]=u})),t.indexOf(Math.min.apply(Math,Object(d.a)(t)))};return Object(p.jsxs)("section",{children:[Object(p.jsxs)("header",{children:[Object(p.jsxs)("h1",{children:["Speed: ",o," floors/sec"]}),Object(p.jsxs)("h1",{children:["Delay: ",n," seconds"]})]}),Object(p.jsxs)("div",{className:"building",children:[Object(p.jsx)(w,{floors:c,addToQueue:function(e){if(!(s.flat().findIndex((function(t){return t===e}))>-1)&&!(b.flat().findIndex((function(t){return t===e}))>-1)){var t=D(e),r=Object(d.a)(s);r[t].push(e),i(r),Q(e,t)}},canUpdate:g,elevatorsQueues:s,floorTimes:x}),Object(p.jsx)(y,{setCanUpdate:L,elevatorsQueues:s,elevatorSpeed:o,elevatorDelay:n,elevatorsLocations:b,removeFromQueue:function(e){if(s[e].length){var t=Object(d.a)(s);t[e].shift(),i(t)}},updateElevatorLocation:function(e){if(s[e].length){var t=Object(d.a)(b);t[e]=s[e][0],m(t)}},floorsCount:t})]})]})},g=r(19);var L=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),r=t[0],n=t[1],o=Object(a.useCallback)(Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g;case 2:t=e.sent,n(t);case 4:case"end":return e.stop()}}),e)}))),[]);return Object(a.useEffect)((function(){o()}),[o]),r&&r.length?Object(p.jsx)("div",{className:"App",children:Object(p.jsx)("div",{className:"street",children:r.map((function(e){return Object(p.jsx)(S,{floorsCount:e.floorsCount,elevatorsCount:e.elevatorsCount,elevatorSpeed:e.elevatorSpeed,elevatorDelay:e.elevatorDelay},e.id)}))})}):Object(p.jsx)("h1",{children:'"Loading..."'})};u.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(L,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.b4fdb63b.chunk.js.map